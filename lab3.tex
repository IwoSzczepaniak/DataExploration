\documentclass{article}

% Language setting
% Replace `english' with e.g. `spanish' to change the document language
\usepackage[polish]{babel}

% Set page size and margins
% Replace `letterpaper' with `a4paper' for UK/EU standard size
\usepackage[a4paper,top=2cm,bottom=2cm,left=3cm,right=3cm,marginparwidth=1.75cm]{geometry}
\usepackage[T1]{fontenc}

% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{float}

\title{Eksploracja Danych - zadanie 3}
\author{Iwo Szczepaniak}

\begin{document}
\maketitle

\section{Przetwarzanie zbioru xy-001}
\begin{verbatim}
Resource name: xy-002.csv
Data with polynomial features:
+--------+----------+------------------+
|       X|         Y|                X2|
+--------+----------+------------------+
|0.411194|-59.938274|    0.169080505636|
|0.549662|-72.006761|    0.302128314244|
|0.860093|-68.979336|    0.739759968649|
| 1.27504|  32.07157|1.6257270015999998|
|2.202931|-91.531894|    4.852904990761|
+--------+----------+------------------+
only showing top 5 rows

root
 |-- X: double (nullable = true)
 |-- Y: double (nullable = true)
 |-- X2: double (nullable = true)
\end{verbatim}

\subsection{Analiza wizualna}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{1.png}
        \caption{Wykres 1}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{2.png}
        \caption{Wykres 2}
    \end{minipage}
\end{figure}

\subsection{Wszystkie pliki}
\subsubsection{Analiza pierwszego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.37.32.png}
        \caption{Wykres 3}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.37.43.png}
        \caption{Wykres 4}
    \end{minipage}
\end{figure}

\subsubsection{Analiza drugiego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{3.png}
        \caption{Wykres 5}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.38.14.png}
        \caption{Wykres 6}
    \end{minipage}
\end{figure}

\subsubsection{Analiza trzeciego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.38.48.png}
        \caption{Wykres 7}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.38.57.png}
        \caption{Wykres 8}
    \end{minipage}
\end{figure}

\subsubsection{Analiza czwartego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.39.22.png}
        \caption{Wykres 9}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.39.30.png}
        \caption{Wykres 10}
    \end{minipage}
\end{figure}

\subsubsection{Analiza piątego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.40.16.png}
        \caption{Wykres 11}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.40.48.png}
        \caption{Wykres 12}
    \end{minipage}
\end{figure}

\subsubsection{Analiza szóstego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.41.01.png}
        \caption{Wykres 13}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.41.48.png}
        \caption{Wykres 14}
    \end{minipage}
\end{figure}

\subsubsection{Analiza siódmego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.41.24.png}
        \caption{Wykres 15}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.42.01.png}
        \caption{Wykres 16}
    \end{minipage}
\end{figure}

\subsubsection{Analiza ósmego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{4e.png}
        \caption{Wykres 17}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{5.png}
        \caption{Wykres 18}
    \end{minipage}
\end{figure}

\subsubsection{Analiza dziewiątego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{1age.png}
        \caption{Wykres 19}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{12e.png}
        \caption{Wykres 20}
    \end{minipage}
\end{figure}

\subsubsection{Analiza dziesiątego zestawu}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.43.09.png}
        \caption{Wykres 21}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Screenshot 2025-03-27 at 15.43.23.png}
        \caption{Wykres 22}
    \end{minipage}
\end{figure}

\subsection{Poprawienie dopasowania}
Ponieważ w poprzednim podpunkcie ustawiłem liczbę iteracji na 100, to wyniki dla zbioru 4 były bardzo dobre, jednak usunięcie regularyzacji umożliwia dopasowanie idealne - wtedy dochodzi do przeuczenia.

\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{asdage.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{1231age.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{imagasde.png}
        \caption{Wykres funkcji straty po zwiększeniu iteracji}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{image.png}
        \caption{Dopasowanie modelu po zwiększeniu iteracji}
    \end{minipage}
\end{figure}

\section{Cechy wielomianowe 3 stopnia}

\subsubsection{Zbiór xy-001}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-001.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-001.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-002}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-002.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-002.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-003}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-003.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-003.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-004}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-004.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-004.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-005}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-005.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-005.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-006}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-006.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-006.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-007}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-007.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-007.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-008}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-008.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-008.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-009}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-009.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-009.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsubsection{Zbiór xy-010}
\begin{figure}[H]
    \centering
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Loss_history_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-010.csv.png}
        \caption{Wykres funkcji straty}
    \end{minipage}
    \hfill
    \begin{minipage}{0.45\textwidth}
        \includegraphics[width=\linewidth]{Pol_reg_(order:_3)_regP=0.3,_elasticNetP=0.8,_maxIter=10_|_xy-010.csv.png}
        \caption{Dopasowanie modelu}
    \end{minipage}
\end{figure}

\subsection{Porównanie wartości miary r2 i MSE dla regresji 2 i 3 stopnia}

\begin{verbatim}
Coefficients for xy-001.csv order 2: [1.354,0.008]
Coefficients for xy-001.csv order 3: [2.016,0.007,-0.000]
--------------------------------
Coefficients for xy-002.csv order 2: [0.000,-1.422]
Coefficients for xy-002.csv order 3: [-11.541,-0.726,-0.010]
--------------------------------
Coefficients for xy-003.csv order 2: [0.000,-1.399]
Coefficients for xy-003.csv order 3: [-11.486,-0.689,-0.011]
--------------------------------
Coefficients for xy-004.csv order 2: [465.840,-9.324]
Coefficients for xy-004.csv order 3: [271.982,-1.279,-0.089]
--------------------------------
Coefficients for xy-005.csv order 2: [3.728,1.816]
Coefficients for xy-005.csv order 3: [-7.420,2.165,0.787]
--------------------------------
Coefficients for xy-006.csv order 2: [0.000,0.000]
Coefficients for xy-006.csv order 3: [0.000,0.000,0.000]
--------------------------------
Coefficients for xy-007.csv order 2: [0.000,0.000]
Coefficients for xy-007.csv order 3: [0.000,0.000,0.000]
--------------------------------
Coefficients for xy-008.csv order 2: [0.000,0.000]
Coefficients for xy-008.csv order 3: [-1.317,-0.079,-0.003]
--------------------------------
Coefficients for xy-009.csv order 2: [0.000,0.000]
Coefficients for xy-009.csv order 3: [-1.119,-0.043,0.000]
--------------------------------
Coefficients for xy-010.csv order 2: [0.000,0.000]
Coefficients for xy-010.csv order 3: [-0.182,0.000,-0.000]
--------------------------------


Dataset         2nd Degree R²   2nd Degree MSE  3rd Degree R²   3rd Degree MSE
--------        -------------   --------------  -------------   --------------
xy-001.csv      | 0.931           | 96.131          | 0.992           | 10.816          
xy-002.csv      | 0.998           | 3043.468        | 0.997           | 3745.423        
xy-003.csv      | 0.899           | 95846.726       | 0.898           | 96836.173       
xy-004.csv      | 0.992           | 23905.603       | 0.932           | 204613.519      
xy-005.csv      | 0.514           | 883.639         | 0.868           | 239.822         
xy-006.csv      | -0.000          | 9.079           | -0.000          | 9.079           
xy-007.csv      | 0.000           | 6.068           | 0.000           | 6.068           
xy-008.csv      | 0.000           | 32.718          | 0.265           | 24.033          
xy-009.csv      | -0.000          | 19.095          | 0.941           | 1.123           
xy-010.csv      | 0.000           | 25.472          | 0.037           | 24.534              
\end{verbatim}

\end{document}